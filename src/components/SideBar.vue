<template>
  <div
    class="d-flex flex-column flex-shrink-0 p-3 bg-light sidebar"
    style="width: 250px; height: 100vh"
  >
    <a
      href="/dashboard"
      class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-dark text-decoration-none"
    >
      <span class="fs-4">ğŸ’° í‘ìë©”ì´ì»¤</span>
    </a>
    <hr />
    <ul class="nav nav-pills flex-column mb-auto">
      <li class="nav-item">
        <router-link
          to="/dashboard"
          class="nav-link"
          :class="{ active: route.path === '/dashboard' }"
        >
          ğŸ  ëŒ€ì‰¬ë³´ë“œ
        </router-link>
      </li>
      <li>
        <router-link
          to="/history"
          class="nav-link"
          :class="{ active: route.path === '/history' }"
        >
          ğŸ’µ ê±°ë˜ë‚´ì—­
        </router-link>
      </li>
      <li>
        <router-link
          to="/calendar"
          class="nav-link"
          :class="{ active: route.path === '/calendar' }"
        >
          ğŸ“… ë‹¬ë ¥
        </router-link>
      </li>
      <li>
        <router-link
          to="/transaction-range"
          class="nav-link"
          :class="{ active: route.path === '/transaction-range' }"
        >
          ğŸ” ê¸°ê°„ë³„ ìƒì„¸ ì¡°íšŒ
        </router-link>
      </li>
      <!-- <li>
        <a @click="goTo('/calendar')" class="nav-link link-dark"> ğŸ’¸ ë‹¬ë ¥ </a>
      </li> -->
    </ul>

    <div class="dropdown user-profile">
      <hr />
      <a
        href="#"
        class="d-flex align-items-center link-dark text-decoration-none dropdown-toggle"
        data-bs-toggle="dropdown"
        aria-expanded="false"
      >
        <!-- âœ… í”„ë¡œí•„ ì´ë¯¸ì§€ ì¶”ê°€ -->
        <img
          :src="`/assets/profile-images/${
            user.currentUser?.profileImage || 'profile1.png'
          }`"
          alt="í”„ë¡œí•„"
          width="32"
          height="32"
          class="rounded-circle me-2"
        />
        <strong>{{ user.currentUser?.name || "ì‚¬ìš©ì" }}</strong>
      </a>
      <ul class="dropdown-menu text-small shadow">
        <li><a class="dropdown-item" @click="goToProfile()">í”„ë¡œí•„ ì„¤ì •</a></li>
        <li><hr class="dropdown-divider" /></li>
        <li><a class="dropdown-item" @click="signout()">ë¡œê·¸ì•„ì›ƒ</a></li>
      </ul>
    </div>
  </div>
</template>

<script setup>
import { useRoute, useRouter } from "vue-router";
import { useUserStore } from "@/stores/userStore";

const route = useRoute();
const router = useRouter();

const goToProfile = () => {
  router.push("/profile");
};

const user = useUserStore();

const signout = () => {
  user.logout();
  router.push("/");
};
</script>

<style scoped>
.sidebar {
  border-right: 1px solid #ddd;
}
.nav-link {
  cursor: pointer;
}
.user-profile {
  margin-top: auto; /* âœ… í•­ìƒ í•˜ë‹¨ ì •ë ¬ */
  padding-top: 1rem;
  padding-bottom: 1rem;
  background-color: #f8f9fa; /* ë³´ê¸° ì¢‹ê²Œ ë°°ê²½ ì¶”ê°€(Optional) */
  position: sticky; /* âœ… ìŠ¤í¬ë¡¤ ì‹œ ì•„ë˜ ê³ ì • íš¨ê³¼ */
  bottom: 0;
  z-index: 1;
}
</style>
